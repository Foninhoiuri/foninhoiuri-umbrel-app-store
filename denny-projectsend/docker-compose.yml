version: '3.7'

services:
  app_proxy:
    environment:
      APP_HOST: denny-projectsend_app_1
      APP_PORT: 80

  app:
    image: lscr.io/linuxserver/projectsend:latest
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - DB_HOST=mysql
      - DB_NAME=projectsend
      - DB_USER=psuser
      - DB_PASS=pspassword
    restart: on-failure
    volumes:
      - ${APP_DATA_DIR}/data/config:/config:rw
      - ${APP_DATA_DIR}/data/ps_data:/data:rw
    depends_on:
      - db

  db:
    image: mysql:5.7
    container_name: projectsend-mysql
    restart: on-failure
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: projectsend
      MYSQL_USER: psuser
      MYSQL_PASSWORD: pspassword
    volumes:
      - ${APP_DATA_DIR}/data/db_data:/var/lib/mysql