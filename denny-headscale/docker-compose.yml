version: "3.7"
services:
  headscale:
    image: headscale/headscale:stable
    container_name: headscale
    volumes:
      - ${APP_DATA_DIR}/config:/etc/headscale
      - ${APP_DATA_DIR}/data:/var/lib/headscale
    environment:
      - HEADSCALE_SERVER_URL=http://headscale:8085
    command: serve
    ports:
      - "8085:8080"
      - "3478:3478/udp"
    restart: on-failure
    networks:
      - headscale_network

  headscale-ui:
    image: ghcr.io/gurucomputing/headscale-ui:latest
    container_name: headscale-ui
    environment:
      - HEADSCALE_URL=http://headscale:8085
      - HTTP_PORT=8086 # Portanpassung f√ºr das UI
    ports:
      - "8086:8086"
    depends_on:
      - headscale
    restart: uon-failure
    networks:
      - headscale_network

networks:
  headscale_network:
    driver: bridge
