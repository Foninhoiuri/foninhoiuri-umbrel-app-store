version: '3.9'

services:
  app_proxy:
    environment:
      APP_HOST: denny-pastefy_app_1  # Host f√ºr die App
      APP_PORT: 80
      PROXY_AUTH_ADD: "false"

  app:  # Der Name des Services sollte hier "app" sein
    image: interaapps/pastefy:6.7.5@sha256:cfa582e598cf00034de9431ce80cba75595d5a7016973e49f8108a90fe8bee76
    environment:
      HTTP_SERVER_PORT: 80
      HTTP_SERVER_CORS: "*"
      DATABASE_DRIVER: mysql
      DATABASE_NAME: pastefy
      DATABASE_USER: pastefy
      DATABASE_PASSWORD: tyooe
      DATABASE_HOST: db
      DATABASE_PORT: 3306
      SERVER_NAME: http://umbrel-2.local:9999
    ports:
      - 9999:80  # Original Pastefy-Port

  db:
    image: mariadb:11.6.2@sha256:a9547599cd87d7242435aea6fda22a9d83e2c06d16c658ef70d2868b3d3f6a80
    volumes:
      - ${APP_DATA_DIR}/data/db:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: tyooe
      MYSQL_DATABASE: pastefy
      MYSQL_USER: pastefy
      MYSQL_PASSWORD: tyooe

volumes:
  pastefy-data:
