version: '3.7'

services:
  app_proxy:
    environment:
      APP_HOST: denny-stalwart_server_1
      APP_PORT: 8080
      PROXY_AUTH_ADD: "false"

  server:
    image: stalwartlabs/stalwart:v0.12.2@sha256:a20b499b380d319eb47a3a3ab497f9a6676190b47597bd781972dcf07d3bbb40
    restart: on-failure
    tty: true
    stdin_open: true
    ports:
      # "8080:8080"   # Web UI / API
      - "1443:443"     # HTTPS
      - "25:25"       # SMTP
      - "587:587"     # SMTP Submission
      - "465:465"     # SMTPS
      - "143:143"     # IMAP
      - "993:993"     # IMAPS
      - "4190:4190"   # Sieve
      - "110:110"     # POP3
      - "995:995"     # POP3S
    volumes:
      - ${APP_DATA_DIR}/data:/opt/stalwart:rw
