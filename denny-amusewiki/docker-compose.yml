services:
  app:
    image: rojen/amusewiki:package
    ports:
      - '8858:80'
      - '8859:443'
    environment:
      - POST_DOMAIN=umbrel-2.local
      - CHANGE_PASSWORD_BEFORE_RUN=true
      - AMW_USERNAME=amusewiki
      - AMW_PASSWORD=changeme
    volumes:
      - ${APP_DATA_DIR}/data/repo:/var/lib/amusewiki/repo:rw
      - ${APP_DATA_DIR}/data/thumb:/var/lib/amusewiki/thumbnails:rw
      - ${APP_DATA_DIR}/data/staging:/var/lib/amusewiki/staging:rw
      - ${APP_DATA_DIR}/data/db:/var/lib/dbconfig-common/sqlite3/amusewiki:rw
      - ${APP_DATA_DIR}/data/web:/etc/nginx/sites-enabled:rw
volumes:
  repo:
  thumb:
  staging:
  db:
  web:
