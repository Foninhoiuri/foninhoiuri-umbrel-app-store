version: '3'

services:
  nginx:
    image: nginx:alpine
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./nginx-selfsigned.crt:/etc/nginx/nginx-selfsigned.crt
      - ./nginx-selfsigned.key:/etc/nginx/nginx-selfsigned.key
    ports:
      - "443:443"
    restart: always

  enclosed:
    image: corentinth/enclosed
    ports:
      - 8525:8787
    volumes:
      - ${APP_DATA_DIR}/data/enclosed-data:/app/.data
    restart: on-failure
    stop_grace_period: 1m
    environment:
      - PUID=1000
      - PGID=1000
    networks:
      - web

networks:
  web:
    driver: bridge
