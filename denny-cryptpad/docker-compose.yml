version: '3.7'

services:
  app_proxy:
    environment:
      APP_HOST: denny-cryptpad_web_1
      APP_PORT: 3000
      PROXY_AUTH_ADD: "false"
  web:
    image: promasu/cryptpad:latest
    restart: on-failure
    volumes:
      - ${APP_DATA_DIR}/data/blob:/cryptpad/blob
      - ${APP_DATA_DIR}/data/block:/cryptpad/block
      - ${APP_DATA_DIR}/customize:/cryptpad/customize
      - ${APP_DATA_DIR}/data/config.js:/cryptpad/config/config.js
      - ${APP_DATA_DIR}/data/data:/cryptpad/data
      - ${APP_DATA_DIR}/data/files:/cryptpad/datastore
    ulimits:
      nofile:
        soft: 1000000
        hard: 1000000      