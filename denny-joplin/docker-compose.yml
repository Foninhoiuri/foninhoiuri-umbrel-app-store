version: '3'
services:
    app:
        environment:
      APP_BASE_URL: http://umbrel.local:22300
      CORS_ALLOW_ORIGIN: http://umbrel.local
      DB_CLIENT: pg
      POSTGRES_PASSWORD: joplinpass
      POSTGRES_DATABASE: joplin
      POSTGRES_USER: joplin
      POSTGRES_PORT: 5432
      POSTGRES_HOST: db
      JOPLIN_EMAIL: admin@localhost
      JOPLIN_PASSWORD: admin
        restart: unless-stopped
        image: florider89/joplin-server:latest
        ports:
            - "22300:22300"
    db:
        restart: unless-stopped
        image: postgres:13.1
        ports:
            - "5432:5432"
        volumes:
            - ${APP_DATA_DIR}/data/joplin/postgres:/var/lib/postgresql/data
        environment:
            - POSTGRES_PASSWORD=joplin
            - POSTGRES_USER=joplin
            - POSTGRES_DB=joplin
